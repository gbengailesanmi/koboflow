"use strict";exports.id=738,exports.ids=[738],exports.modules={5631:(a,b,c)=>{Object.defineProperty(b,"__esModule",{value:!0}),Object.defineProperty(b,"isNextRouterError",{enumerable:!0,get:function(){return f}});let d=c(22859),e=c(31903);function f(a){return(0,e.isRedirectError)(a)||(0,d.isHTTPAccessFallbackError)(a)}("function"==typeof b.default||"object"==typeof b.default&&null!==b.default)&&void 0===b.default.__esModule&&(Object.defineProperty(b.default,"__esModule",{value:!0}),Object.assign(b.default,b),a.exports=b.default)},20502:(a,b,c)=>{c.d(b,{j2:()=>k,Jv:()=>j});var d=c(59873),e=c(33980),f=c(92493),g=c(48214);let h={pages:{signIn:"/login"},callbacks:{async authorized({auth:a,request:{nextUrl:b}}){let c=!!a?.user,d=b.pathname,e=["/","/verify-email","/auth-redirect"].some(a=>d===a||d.startsWith(a+"/"));return!!d.startsWith("/api")||"/auth-redirect"===d||(c&&("/login"===d||"/signup"===d)?Response.redirect(new URL("/auth-redirect",b)):!c&&("/login"===d||"/signup"===d)||!c&&!!e||!!c)}},providers:[]},i=(0,d.Ay)({...h,providers:[(0,e.A)({clientId:process.env.GOOGLE_CLIENT_ID,clientSecret:process.env.GOOGLE_CLIENT_SECRET,authorization:{params:{prompt:"consent",access_type:"offline",response_type:"code"}}}),(0,f.A)({name:"credentials",credentials:{email:{label:"Email",type:"email"},password:{label:"Password",type:"password"}},async authorize(a){if(!a?.email||!a?.password)return null;let{connectDB:b}=await Promise.resolve().then(c.bind(c,22527)),d=await Promise.resolve().then(c.t.bind(c,5486,23)),e=await b(),f=await e.collection("users").findOne({email:a.email.toLowerCase()});if(!f||!f.password)return console.log("User not found or no password for email:",a.email),null;if(!await d.compare(a.password,f.password))return console.log("Invalid password for email:",a.email),null;if(!f.emailVerified)throw console.log("Email not verified for:",a.email,"emailVerified value:",f.emailVerified),Error("Please verify your email before logging in. Check your inbox for the verification link.");return{id:f._id.toString(),email:f.email,name:`${f.firstName} ${f.lastName}`,customerId:f.customerId}}})],callbacks:{...h.callbacks,async signIn({user:a,account:b}){if(b?.provider==="google"){let{connectDB:b}=await Promise.resolve().then(c.bind(c,22527)),{createUserSettings:d}=await c.e(853).then(c.bind(c,94853)),e=await b(),f=await e.collection("users").findOne({email:a.email});if(f)if(f.customerId)a.customerId=f.customerId;else{let b=(0,g.A)();await e.collection("users").updateOne({email:a.email},{$set:{customerId:b,authProvider:"google"}}),await d(b),a.customerId=b}else{let b=(0,g.A)(),c=a.name?.split(" ")||["",""],f=c[0]||"",h=c.slice(1).join(" ")||"";await e.collection("users").updateOne({email:a.email},{$set:{customerId:b,firstName:f,lastName:h,emailVerified:!0,createdAt:new Date,authProvider:"google"}},{upsert:!0}),await d(b),a.customerId=b}}return!0},jwt:async({token:a,user:b,account:c})=>(b?.customerId&&(a.customerId=b.customerId),a),session:async({session:a,token:b})=>(b?.customerId?a.user.customerId=b.customerId:console.error("No customerId in token for session"),a),redirect:async({url:a,baseUrl:b})=>a.startsWith("/")?`${b}${a}`:a.startsWith(b)?a:`${b}/auth-redirect`},session:{strategy:"jwt",maxAge:604800},secret:process.env.NEXTAUTH_SECRET});i.handlers;let j=i.signIn;i.signOut;let k=i.auth},22527:(a,b,c)=>{c.d(b,{connectDB:()=>k});var d=c(12518);let e=process.env.MONGODB_URI,f=process.env.MONGO_DB_NAME;if(!e)throw Error("Missing MONGODB_URI");let g=globalThis.__mongoClient,h=globalThis.__mongoClientPromise,i=!1;async function j(a){if(!i)try{await a.collection("settings").createIndex({customerId:1},{unique:!0}),await a.collection("settings").createIndex({updatedAt:-1}),i=!0}catch(a){console.error("Error creating indexes:",a)}}async function k(){if(g)return g.db(f);if(!h){let a=new d.MongoClient(e);h=a.connect().then(async()=>{globalThis.__mongoClient=a,console.log("MongoDB online âœ…");let b=a.db(f);return await j(b),a}),globalThis.__mongoClientPromise=h}let a=await h;return g=a,a.db(f)}},22859:(a,b)=>{Object.defineProperty(b,"__esModule",{value:!0}),!function(a,b){for(var c in b)Object.defineProperty(a,c,{enumerable:!0,get:b[c]})}(b,{HTTPAccessErrorStatus:function(){return c},HTTP_ERROR_FALLBACK_ERROR_CODE:function(){return e},getAccessFallbackErrorTypeByStatus:function(){return h},getAccessFallbackHTTPStatus:function(){return g},isHTTPAccessFallbackError:function(){return f}});let c={NOT_FOUND:404,FORBIDDEN:403,UNAUTHORIZED:401},d=new Set(Object.values(c)),e="NEXT_HTTP_ERROR_FALLBACK";function f(a){if("object"!=typeof a||null===a||!("digest"in a)||"string"!=typeof a.digest)return!1;let[b,c]=a.digest.split(";");return b===e&&d.has(Number(c))}function g(a){return Number(a.digest.split(";")[1])}function h(a){switch(a){case 401:return"unauthorized";case 403:return"forbidden";case 404:return"not-found";default:return}}("function"==typeof b.default||"object"==typeof b.default&&null!==b.default)&&void 0===b.default.__esModule&&(Object.defineProperty(b.default,"__esModule",{value:!0}),Object.assign(b.default,b),a.exports=b.default)},23746:(a,b,c)=>{c.d(b,{Q:()=>f});var d=c(3742);c(93200);var e=c(20502);async function f(){await (0,e.Jv)("google",{redirectTo:"/auth-redirect"})}(0,c(77256).D)([f]),(0,d.A)(f,"00de0c7dd6dba7c67197b2796253f1dc68ae905e11",null)},25388:(a,b,c)=>{c.d(b,{Q:()=>e});var d=c(70358);let e=(0,d.createServerReference)("00de0c7dd6dba7c67197b2796253f1dc68ae905e11",d.callServer,void 0,d.findSourceMapURL,"handleGoogleSignIn")},31903:(a,b,c)=>{Object.defineProperty(b,"__esModule",{value:!0}),!function(a,b){for(var c in b)Object.defineProperty(a,c,{enumerable:!0,get:b[c]})}(b,{REDIRECT_ERROR_CODE:function(){return e},RedirectType:function(){return f},isRedirectError:function(){return g}});let d=c(49005),e="NEXT_REDIRECT";var f=function(a){return a.push="push",a.replace="replace",a}({});function g(a){if("object"!=typeof a||null===a||!("digest"in a)||"string"!=typeof a.digest)return!1;let b=a.digest.split(";"),[c,f]=b,g=b.slice(2,-2).join(";"),h=Number(b.at(-2));return c===e&&("replace"===f||"push"===f)&&"string"==typeof g&&!isNaN(h)&&h in d.RedirectStatusCode}("function"==typeof b.default||"object"==typeof b.default&&null!==b.default)&&void 0===b.default.__esModule&&(Object.defineProperty(b.default,"__esModule",{value:!0}),Object.assign(b.default,b),a.exports=b.default)},44989:(a,b,c)=>{Object.defineProperty(b,"__esModule",{value:!0}),Object.defineProperty(b,"createDedupedByCallsiteServerErrorLoggerDev",{enumerable:!0,get:function(){return i}});let d=function(a,b){if(a&&a.__esModule)return a;if(null===a||"object"!=typeof a&&"function"!=typeof a)return{default:a};var c=e(b);if(c&&c.has(a))return c.get(a);var d={__proto__:null},f=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var g in a)if("default"!==g&&Object.prototype.hasOwnProperty.call(a,g)){var h=f?Object.getOwnPropertyDescriptor(a,g):null;h&&(h.get||h.set)?Object.defineProperty(d,g,h):d[g]=a[g]}return d.default=a,c&&c.set(a,d),d}(c(61365));function e(a){if("function"!=typeof WeakMap)return null;var b=new WeakMap,c=new WeakMap;return(e=function(a){return a?c:b})(a)}let f={current:null},g="function"==typeof d.cache?d.cache:a=>a,h=console.warn;function i(a){return function(...b){h(a(...b))}}g(a=>{try{h(f.current)}finally{f.current=null}})},72610:(a,b)=>{Object.defineProperty(b,"__esModule",{value:!0}),Object.defineProperty(b,"isPostpone",{enumerable:!0,get:function(){return d}});let c=Symbol.for("react.postpone");function d(a){return"object"==typeof a&&null!==a&&a.$$typeof===c}},90507:(a,b)=>{Object.defineProperty(b,"__esModule",{value:!0}),!function(a,b){for(var c in b)Object.defineProperty(a,c,{enumerable:!0,get:b[c]})}(b,{BailoutToCSRError:function(){return d},isBailoutToCSRError:function(){return e}});let c="BAILOUT_TO_CLIENT_SIDE_RENDERING";class d extends Error{constructor(a){super("Bail out to client-side rendering: "+a),this.reason=a,this.digest=c}}function e(a){return"object"==typeof a&&null!==a&&"digest"in a&&a.digest===c}}};